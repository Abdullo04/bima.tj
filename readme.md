# Страховой калькулятор Bima.TJ — Backend API

MVP backend-сервис для расчёта стоимости страхового полиса, оформления заявок и управления пользователями с JWT-аутентификацией.

---

## Технологии
- Python3.10
- FastAPI  
- PostgreSQL  
- SQLAlchemy (Async ORM)  
- Alembic (миграции)  
- Pydantic  
- JWT  
- Swagger / OpenAPI  
- Docker (опционально)  

---

## Запуск проекта

1. Клонировать репозиторий и установить зависимости:
   ```bash
   git clone https://github.com/Abdullo04/bima.tj.git
   cd bima.tj
   python3 -m venv .venv
   source .venv/bin/activate
   pip install -r requirements.txt
   ```

2. Настроить подключение к базе данных в .env или конфиге:
   ```
   DB_USER=developer
   DB_PASSWORD=313
   DB_HOST=localhost
   DB_PORT=5432
   DB_NAME=postgres
   PASSWORD_SALT=your_salt
   JWT_SECRET_KEY=your_secret_key
   JWT_ALGORITHM=HS256
   JWT_DAY_EXPIRE=1
   ```
3. Применить миграции:
   ```
   alembic upgrade head
   ```
4. Запустить сервер:
   ```
   uvicorn app.main:app --reload
   ```

## Документация API

Доступна по адресу:
http://localhost:8000/docs

## Аутентификация

Используется JWT. Для доступа к защищённым маршрутам необходимо передавать токен в заголовке:

## Основной функционал

* Регистрация и вход пользователей с JWT-аутентификацией

* Расчёт стоимости полиса с учётом тарифов, возраста, стажа и типа авто

* Создание и просмотр заявок (для авторизованных пользователей)

# Коэффициенты для расчёта стоимости полиса

Ниже приведены коэффициенты, которые используются в формуле для расчёта стоимости страхового полиса.

---

## Коэффициенты тарифов (базовая стоимость)

| Тариф     | Коэффициент (базовая цена) |
|-----------|----------------------------|
| BASIC     | 500                        |
| STANDART  | 1000                       |
| PREMIUM   | 1500                       |

---

## Коэффициенты по возрасту

| Возраст       | Коэффициент |
|---------------|-------------|
| 18–22         | 1.5         |
| 23–30         | 1.3         |
| 31–40         | 1.1         |
| 41–100        | 1.0         |

---

## Коэффициенты по опыту вождения (стаж)

| Стаж (лет)    | Коэффициент |
|---------------|-------------|
| 0–5           | 1.5         |
| 6–10          | 1.3         |
| 11–15         | 1.1         |
| 16–100        | 1.0         |

---

## Коэффициенты по типу автомобиля

| Тип автомобиля | Коэффициент |
|----------------|-------------|
| CAR            | 1.1         |
| VAN            | 1.3         |
| TRUCK          | 1.5         |

---

## Формула расчёта стоимости полиса
```
цена = тариф_коэффициент × возрастной_коэффициент × коэффициент_стажа × коэффициент_типа_авто
```


Где:
- тариф_коэффициент — базовая цена в зависимости от тарифа;
- остальные — множители из таблиц выше.
